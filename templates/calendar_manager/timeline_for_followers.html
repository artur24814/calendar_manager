{% extends 'calendar_manager/base.html' %}
{% block title %}{{ month }} {{ day }}{% endblock %}
{% block content %}

{% load widget_tweaks %}
<div class="drive-wrapper drive-list-view" style="background-color: #bfbfe3">
  <div class="container">
	{% if messages %}
	    {% for message in messages %}
	       	<div class="alert alert-success alert-dismissible fade show" role="alert">
             	{{ message }}
              	<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
           	</div>
	    {% endfor %}
	{% endif %}
	{% if request.user.is_authenticated %}
	<div class="card" style="background: rgba( 255, 255, 255, 0.6 );
	                           padding: 10px;
                               backdrop-filter: blur( 7px );
                               -webkit-backdrop-filter: blur( 7px );
                               border: 1px solid rgba(107,94,94,0.18);
                               -webkit-box-shadow: -1px -3px 24px 0px rgb(146,147,161);
                               -moz-box-shadow: -1px -3px 24px 0px rgb(176,177,183);
                               box-shadow: 10px 3px 24px 0px rgba(66, 68, 90, 10);">
		<form method="post">{% csrf_token %}
	       	<div class="row mt-3">
		       	<div class="col-md-6">
                        <label class="labels" for="{{ form.time_start.id_for_label }}">
							Start meeting at
						</label>
                        {%  render_field form.time_start class="form-control" %}
		       	</div>
		       	<div class="col-md-6">
		            <button class="btn btn-primary profile-button" type="submit">Ask for meeting</button>
		       	</div>
			   	<div class="col-md-12">
                    <label class="labels" for="{{ form.title.id_for_label }}">Title</label>
                    {%  render_field form.title class="form-control" placeholder="enter title"%}
                        {% if form.title.errors %}
                             {% for error in form.title.errors %}
                             <strong style="color: red">{{ error|escape }}</strong>
                             {% endfor %}
                        {% endif %}
			   	</div>
			   	<div class="col-md-12">
                    <label class="labels" for="{{ form.message.id_for_label }}">Message</label>
                    {%  render_field form.message class="form-control" placeholder="write message" rows='2' %}
                    	{% if form.message.errors %}
                             {% for error in form.message.errors %}
                             <strong style="color: red">{{ error|escape }}</strong>
                             {% endfor %}
                        {% endif %}
			   	</div>
		   	</div>
		</form>
	</div>
	{% else %}
	{% endif %}
    <div class="timeline" style="background-color: #bfbfe3">
		{% for meeting in meetings %}
			{% if meeting.confirmed is True%}
				{% if meeting.asker == request.user or meeting.replied == request.user %}
					<div class="timeline-row">
						<div class="timeline-time">
							{{ meeting.time_start|time:'H:i' }} - {{ meeting.time_finish|time:'H:i' }}
						</div>
						<div class="timeline-content">
							<i class="icon-attachment"></i>
							<h4>Meeting</h4>
							<p>{{ meeting.title }}</p>
							<div class="thumbs">
								<img class="img-fluid rounded" src="{{ meeting.asker.profile.image.url }}" alt="Maxwell Admin">
								<img class="img-fluid rounded" src="{{ meeting.replied.profile.image.url }}" alt="Maxwell Admin">
							</div>
							<div class="">
								<span class="badge badge-pill">{{ meeting.asker.first_name }} {{ meeting.asker.last_name }}</span>
								<span class="badge badge-pill">{{ meeting.replied.first_name }} {{ meeting.replied.last_name }}</span>
							</div>
						</div>
					</div>
				{% else %}
					<div class="timeline-row">
						<div class="timeline-time">
							{{ meeting.time_start|time:'H:i' }} - {{ meeting.time_finish|time:'H:i' }}
						</div>
						<div class="timeline-content">
							<i class="icon-attachment"></i>
							<h4>Meeting</h4>
						</div>
					</div>
				{% endif %}
			{% endif %}
		{% endfor %}
	</div>
  </div>
</div>
{% endblock %}